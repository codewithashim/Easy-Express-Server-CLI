# Easy Express CWA ğŸš€

`easy-express` is a CLI tool to automate the setup of a common Express.js backend. This tool helps you quickly scaffold a backend setup without rewriting the setup each time.

## Features âœ¨

- **Predefined Backend Setup**: Copies a predefined backend setup to your current working directory.
- **Common Configurations**: Includes configurations such as `.env.example`, `.eslintignore`, `.eslintrc`, `.gitignore`, `.prettierrc`, `docker-compose.yml`, `Dockerfile`, `package.json`, and `tsconfig.json`.
- **Prebuilt Functionalities**:
  * ğŸ” Authentication and authorization
  * ğŸ”‘ JWT handling
  * ğŸ”— Login with Google Auth
  * ğŸ“œ Logger setup
  * ğŸ³ Docker configuration
  * ğŸš€ Redis integration
  * ğŸ“‚ File upload middleware (Cloudinary, AWS S3)
  * ğŸ“˜ Swagger for API documentation
  * ğŸª Cookies handling
  * ğŸ”’ Security features
  * ğŸ› ï¸ Many more features upcoming

## Installation ğŸ› 

```sh
npm install -g easy-express-cwa
mkdir server
```

```sh
cd server
```

```sh
npx easy-express-cwa
```

Configure your environment variables:

Copy the `.env.example` file to `.env` and update the values as needed:

```sh
NODE_ENV=development
PORT=8000
DB_URL=mongodb://localhost:27017/yourdb
ENCRYPTION_METHOD=AES-256-CBC
ENCRYPTION_KEY=DR8j97BtgHVBiEKAjqRlfn6VSLTJTIpwsgNo0vTWKvA=
BCRYPT_SALT_ROUNDS=14

DOMAIN=yourdomain.com

APP_ID=your-app-id
APP_CERTIFICATE=your-app-certificate

JWT_SECRET=GiCj9Qrmy4vYeDbBjrVCszy0xlN5PGZQQ77iLExHVuI=
JWT_REFRESH_SECRET=jiS8zP3qHU2fgKblrhqVKhFEYYqpwsrh/6Z/Ak0ZhL8=
JWT_EXPIRATION_TIME=3d
JWT_REFRESH_EXPIRATION_TIME=3d

CLOUDINARY_CLOUD_NAME=""
CLOUDINARY_API_KEY=""
CLOUDINARY_API_SECRET=""

REDIS_PASSWORD=your-redis-password
REDIS_HOST=your-redis-host
REDIS_PORT=your-redis-port

GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=your-google-callback-url
GOOGLE_REDIRECT_URL=your-google-redirect-url
GOOGLE_APP_USER=your-google-app-user
GOOGLE_APP_PASSWORD=your-google-app-password

```

# Folder Structure ğŸ“‚

Here's the folder structure generated by `easy-express`:

```
â””â”€â”€ ğŸ“ server
    â””â”€â”€ ğŸš« .dockerignore
    â””â”€â”€ ğŸ› ï¸ .env
    â””â”€â”€ ğŸ› ï¸ .env.example
    â””â”€â”€ ğŸ³ Dockerfile
    â””â”€â”€ ğŸ“œ README.md
    â””â”€â”€ ğŸ³ docker-compose.yml
    â””â”€â”€ ğŸ“¦ package.json
    â””â”€â”€ ğŸ“ src
        â””â”€â”€ ğŸ“ app
            â””â”€â”€ ğŸ“ middlewares
                â””â”€â”€ ğŸ”’ auth.ts
                â””â”€â”€ ğŸ“ cloudinary
                    â””â”€â”€ â˜ï¸ cloudinary.ts
                â””â”€â”€ âš ï¸ globalErrorHandler.ts
                â””â”€â”€ ğŸ› ï¸ handleZodError.ts
                â””â”€â”€ ğŸ“ multer
                    â””â”€â”€ ğŸ“¤ multer.ts
                â””â”€â”€ ğŸ“ redis
                    â””â”€â”€ ğŸ› ï¸ redis.ts
                â””â”€â”€ âœ… validateRequest.ts
            â””â”€â”€ ğŸ“ modules
                â””â”€â”€ ğŸ“ auth
                    â””â”€â”€ ğŸ‘¤ auth.controller.ts
                    â””â”€â”€ ğŸš¦ auth.route.ts
                    â””â”€â”€ ğŸ› ï¸ auth.service.ts
                â””â”€â”€ ğŸ“ example
                    â””â”€â”€ ğŸ“„ example.controller.ts
                    â””â”€â”€ ğŸ“„ example.interface.ts
                    â””â”€â”€ ğŸ—ƒï¸ example.model.ts
                    â””â”€â”€ ğŸš¦ example.route.ts
                    â””â”€â”€ ğŸ› ï¸ example.service.ts
                    â””â”€â”€ âœ… example.validation.ts
                â””â”€â”€ ğŸ“ googleOAuth
                    â””â”€â”€ ğŸŒ googleOAuth.controller.ts
                    â””â”€â”€ ğŸš¦ googleOAuth.route.ts
                    â””â”€â”€ ğŸ› ï¸ googleOAuth.service.ts
                â””â”€â”€ ğŸ“ user
                    â””â”€â”€ ğŸ‘¤ user.controller.ts
                    â””â”€â”€ ğŸ—ƒï¸ user.interface.ts
                    â””â”€â”€ ğŸ—ƒï¸ user.model.ts
                    â””â”€â”€ ğŸš¦ user.route.ts
                    â””â”€â”€ ğŸ› ï¸ user.service.ts
                    â””â”€â”€ âœ… user.validation.ts
            â””â”€â”€ ğŸ“ routes
                â””â”€â”€ ğŸš¦ index.ts
        â””â”€â”€ ğŸ› ï¸ app.ts
        â””â”€â”€ ğŸ“ config
            â””â”€â”€ âš™ï¸ index.ts
            â””â”€â”€ ğŸ›‚ passport.ts
        â””â”€â”€ ğŸ“ constants
            â””â”€â”€ ğŸ’¬ message.ts
            â””â”€â”€ ğŸ”¢ pagination.ts
            â””â”€â”€ â³ redisCacheExpireDate.ts
            â””â”€â”€ ğŸ”‘ redisKeys.ts
        â””â”€â”€ ğŸ“ enums
            â””â”€â”€ ğŸ“„ common.ts
            â””â”€â”€ ğŸ“„ user.ts
        â””â”€â”€ ğŸ“ errors
            â””â”€â”€ ğŸ› ï¸ ApiError.ts
            â””â”€â”€ âŒ handleCastError.ts
            â””â”€â”€ ğŸ› ï¸ handleValidationError.ts
            â””â”€â”€ ğŸ› ï¸ handleZodError.ts
        â””â”€â”€ ğŸ“ helpers
            â””â”€â”€ ğŸ›¡ï¸ jwtHelper.ts
            â””â”€â”€ ğŸ› ï¸ paginationHelper.ts
        â””â”€â”€ ğŸ“ interfaces
            â””â”€â”€ ğŸ“„ common.ts
            â””â”€â”€ ğŸ“„ error.ts
            â””â”€â”€ ğŸ“„ index.d.ts
            â””â”€â”€ ğŸ“„ pagination.ts
        â””â”€â”€ ğŸ› ï¸ server.ts
        â””â”€â”€ ğŸ“ shared
            â””â”€â”€ ğŸ› ï¸ catchAsync.ts
            â””â”€â”€ ğŸ“‹ logger.ts
            â””â”€â”€ ğŸ› ï¸ pick.ts
            â””â”€â”€ âœ‰ï¸ sendResponse.ts
        â””â”€â”€ ğŸ“ utils
            â””â”€â”€ ğŸ“§ mail.util.ts
            â””â”€â”€ ğŸ”‘ oAuth.ts
    â””â”€â”€ âš™ï¸ tsconfig.json
    â””â”€â”€ ğŸ“¦ yarn.lock

```

### API Documentation

Access the Swagger API documentation at `http://localhost:3000/api-docs`.

## Contributing ğŸ¤

Contributions are welcome! Please open an issue or submit a pull request for any improvements.

## License ğŸ“„

This project is licensed under the MIT License.

## Contact ğŸ“¬

For any inquiries or feedback, please reach out at [codewithashim@gmail.com]().

# **Example**

To add the example code snippets for the `example` entity CRUD operations in your `README.md` file, you can follow this structure:

1. **Overview of the Example Module**
2. **Interface**
3. **Model**
4. **Controller**
5. **Service**
6. **Route**
7. **Validation**

Hereâ€™s how you can add them to your `README.md`:

# Example Module

This module provides CRUD operations for the `example` entity. Below are the code snippets for the controller, interface, model, route, service, and validation.

## Interface

```typescript
import { Model } from "mongoose";

export type IExample = {
  title: string;
  description: string;
  createdAt?: Date;
  updatedAt?: Date;
}

export type ExampleModel =Model<IExample, Record<string, unknown>>;

```

## Model

```typescript
import { Schema, model } from "mongoose";
import { IExample, ExampleModel } from "./example.interface";

const ExampleSchema = new Schema<IExample>(
  {
    name: {
      type: String,
      required: true,
    },
    description: {
      type: String,
      required: true,
    },
  },
  {
    timestamps: true,
    toJSON: {
      virtuals: true,
    },
  }
);

export const Example = model<IExample, ExampleModel>("Example", ExampleSchema);

```

## Controller

```typescript
import { Request, Response } from "express";
import httpStatus from "http-status";
import catchAsync from "../../../shared/catchAsync";
import sendResponse from "../../../shared/sendResponse";
import { IExample } from "./example.interface";
import { ExampleService } from "./example.service";
import { responseMessage } from "../../../constants/message";

const getAllExamples = catchAsync(async (req: Request, res: Response) => {
  const result = await ExampleService.getAllExamples();
  
  sendResponse<IExample[]>(res, {
    statusCode: httpStatus.OK,
    success: true,
    message: responseMessage.GET_ALL_EXAMPLES_MESSAGE,
    data: result,
  });
});

const getExampleById = catchAsync(async (req: Request, res: Response) => {
  const result = await ExampleService.getExampleById(req.params.id);

  sendResponse<IExample>(res, {
    statusCode: httpStatus.OK,
    success: true,
    message: responseMessage.GET_EXAMPLE_BY_ID_MESSAGE,
    data: result,
  });
});

const updateExample = catchAsync(async (req: Request, res: Response) => {
  const id = req.params.id;
  const updatedData = req.body;

  const result = await ExampleService.updateExample(id, updatedData);

  sendResponse<IExample>(res, {
    statusCode: httpStatus.OK,
    success: true,
    message: responseMessage.UPDATE_EXAMPLE_MESSAGE,
    data: result,
  });
});

const deleteExample = catchAsync(async (req: Request, res: Response) => {
  const { id } = req.params;
  const result = await ExampleService.deleteExample(id);
  sendResponse<IExample>(res, {
    statusCode: httpStatus.OK,
    success: true,
    message: responseMessage.DELETE_EXAMPLE_MESSAGE,
    data: result,
  });
});

export const ExampleController = {
  getAllExamples,
  getExampleById,
  updateExample,
  deleteExample,
};
```

## Service

```typescript
import ApiError from "../../../errors/ApiError";
import { Example } from "./example.model";
import { IExample } from "./example.interface";
import httpStatus from "http-status";
import { responseMessage } from "../../../constants/message";

const getAllExamples = async (): Promise<Array<IExample>> => {
  try {
    const examples = await Example.find();
    return examples;
  } catch (error) {
    throw new ApiError(
      httpStatus.INTERNAL_SERVER_ERROR,
      `${responseMessage.FAILED_MESSAGE} get all examples`
    );
  }
};

const getExampleById = async (id: string): Promise<IExample | null> => {
  try {
    const example = await Example.findById(id);
    if (!example) {
      throw new ApiError(
        httpStatus.NOT_FOUND,
        `Example ${responseMessage.NOT_FOUND_MESSAGE}`
      );
    }
    return example;
  } catch (error) {
    throw new ApiError(
      httpStatus.INTERNAL_SERVER_ERROR,
      `${responseMessage.FAILED_MESSAGE} get example by ID`
    );
  }
};

const updateExample = async (
  id: string,
  payload: Partial<IExample>
): Promise<IExample | null> => {
  try {
    const isExist = await Example.findOne({ _id: id });
    if (!isExist) {
      throw new ApiError(
        httpStatus.NOT_FOUND,
        `Example ${responseMessage.NOT_FOUND_MESSAGE}`
      );
    }

    const updateExampleData = payload;

    const result = await Example.findOneAndUpdate({ _id: id }, updateExampleData, {
      new: true,
    });
    return result;
  } catch (error) {
    throw new ApiError(
      httpStatus.INTERNAL_SERVER_ERROR,
      `${responseMessage.FAILED_MESSAGE} update example`
    );
  }
};

const deleteExample = async (id: string): Promise<IExample | null> => {
  try {
    const example = await Example.findByIdAndDelete(id);
    if (!example) {
      throw new ApiError(
        httpStatus.NOT_FOUND,
        `Example ${responseMessage.NOT_FOUND_MESSAGE}`
      );
    }
    return example;
  } catch (error) {
    throw new ApiError(
      httpStatus.INTERNAL_SERVER_ERROR,
      `${responseMessage.FAILED_MESSAGE} delete example`
    );
  }
};

export const ExampleService = {
  getAllExamples,
  getExampleById,
  updateExample,
  deleteExample,
};

```

## Route

```typescript
import express from "express";
import validateRequest from "../../middlewares/validateRequest";
import { ExampleController } from "./example.controller";
import { createExampleValidator } from "./example.validation";
const router = express.Router();

router.get("/", ExampleController.getAllExamples);
router.get("/:id", ExampleController.getExampleById);
router.patch(
  "/:id",
  validateRequest(createExampleValidator.updateExampleZodSchema),
  ExampleController.updateExample
);
router.delete("/:id", ExampleController.deleteExample);

export const ExampleRoutes = router
```

## Validation

```typescript
import { z } from "zod";

const createExampleZodSchema = z.object({
  body: z.object({
    name: z.string({
      required_error: "Name is required",
    }),
    description: z.string({
      required_error: "Description is required",
    }),
  }),
});

const updateExampleZodSchema = z.object({
  body: z.object({
    name: z.string().optional(),
    description: z.string().optional(),
  }),
});

export const createExampleValidator = {
  createExampleZodSchema,
  updateExampleZodSchema,
};

```
